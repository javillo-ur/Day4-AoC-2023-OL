Console.WriteLine(File.ReadAllLines("input.txt").Select(r => r.Split(":")[1]).Select((r, index) => new{winning = r.Split("|")[0].Split(" ").Where(t => int.TryParse(t , out _)).Select(t => int.Parse(t)), numbers = r.Split("|")[1].Split(" ").Where(t => int.TryParse(t , out _)).Select(t => int.Parse(t))}).Select(r => r.numbers.Aggregate(0, (previous, current) => r.winning.Contains(current) ? (previous + 1) : previous)).Reverse().Aggregate(new List<int>() as IEnumerable<int>, (previous, current) => previous.Append(1 + previous.Skip(previous.Count() - current).Sum())).Sum());